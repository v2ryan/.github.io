<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Top LLM &amp; AI GitHub Stars (Weekly)</title>
    <style>
      :root {
        color-scheme: dark;
        --bg-base: #070b16;
        --bg-panel: rgba(15, 23, 42, 0.86);
        --accent: #38bdf8;
        --accent-strong: #22d3ee;
        --text: #e2e8f0;
        --text-soft: rgba(226, 232, 240, 0.75);
        --border: rgba(148, 163, 184, 0.28);
        font-family: "Inter", "Segoe UI", "Helvetica Neue", Arial, sans-serif;
      }

      * { box-sizing: border-box; }

      body {
        margin: 0;
        min-height: 100vh;
        display: flex;
        align-items: center;
        justify-content: center;
        padding: clamp(20px, 5vw, 48px);
        background:
          radial-gradient(circle at 12% 18%, rgba(56, 189, 248, 0.22), transparent 60%),
          radial-gradient(circle at 88% 12%, rgba(129, 140, 248, 0.16), transparent 62%),
          linear-gradient(140deg, #020617 0%, #0f172a 60%, #1e293b 100%);
        color: var(--text);
      }

      main {
        width: min(920px, 100%);
        background: var(--bg-panel);
        border-radius: 28px;
        border: 1px solid var(--border);
        box-shadow: 0 28px 60px rgba(2, 6, 23, 0.45);
        padding: clamp(24px, 4vw, 44px);
        backdrop-filter: blur(18px);
        position: relative;
      }

      header {
        display: flex;
        flex-direction: column;
        gap: 12px;
        margin-bottom: clamp(24px, 4vw, 36px);
      }

      /* Language toggle */
      .top-bar {
        position: absolute;
        top: clamp(16px, 3vw, 24px);
        right: clamp(16px, 3vw, 24px);
        display: flex;
        justify-content: flex-end;
      }
      .lang-toggle {
        display: inline-flex;
        align-items: center;
        gap: 6px;
        padding: 8px 14px;
        border-radius: 999px;
        border: 1px solid rgba(148, 163, 184, 0.3);
        background: rgba(15, 23, 42, 0.7);
        color: var(--text);
        cursor: pointer;
        font-size: 0.85rem;
        font-weight: 600;
        transition: border-color 0.18s ease, background 0.18s ease, color 0.18s ease;
      }
      .lang-toggle:hover,
      .lang-toggle:focus-visible {
        border-color: rgba(56, 189, 248, 0.6);
        color: var(--accent-strong);
        outline: none;
      }
      .lang-toggle span { opacity: 0.6; transition: opacity 0.18s ease; }
      .lang-toggle span[data-active="true"] { opacity: 1; }

      .breadcrumb {
        font-size: 0.85rem;
        color: var(--text-soft);
        display: inline-flex;
        gap: 8px;
        align-items: center;
      }
      .breadcrumb a { color: var(--accent); text-decoration: none; font-weight: 600; }
      .breadcrumb a:hover { text-decoration: underline; }

      h1 {
        margin: 0;
        font-size: clamp(2rem, 4.8vw, 2.6rem);
        font-weight: 700;
      }

      .lead {
        margin: 0;
        font-size: 1rem;
        color: var(--text-soft);
        line-height: 1.6;
        max-width: 680px;
      }

      .snapshot-meta {
        display: flex;
        flex-wrap: wrap;
        gap: 12px;
        margin: clamp(16px, 3vw, 24px) 0;
        font-size: 0.86rem;
        color: rgba(148, 163, 184, 0.85);
      }
      .snapshot-meta span {
        display: inline-flex;
        align-items: center;
        gap: 6px;
        background: rgba(15, 23, 42, 0.68);
        border-radius: 999px;
        padding: 6px 12px;
        border: 1px solid rgba(148, 163, 184, 0.24);
      }

      table {
        width: 100%;
        border-collapse: collapse;
        background: rgba(15, 23, 42, 0.7);
        border-radius: 22px;
        overflow: hidden;
        border: 1px solid rgba(148, 163, 184, 0.26);
      }
      thead { background: rgba(15, 23, 42, 0.9); }
      th, td {
        padding: clamp(14px, 2.8vw, 18px);
        text-align: left;
        border-bottom: 1px solid rgba(148, 163, 184, 0.18);
      }
      th {
        font-size: 0.78rem;
        letter-spacing: 0.08em;
        text-transform: uppercase;
        color: rgba(148, 163, 184, 0.8);
      }
      tbody tr:last-child td { border-bottom: none; }
      tbody tr:hover { background: rgba(30, 64, 175, 0.18); }

      .repo { display: flex; flex-direction: column; gap: 6px; }
      .repo a { color: var(--accent); font-weight: 600; text-decoration: none; }
      .repo a:hover { text-decoration: underline; }

      .tags { display: inline-flex; flex-wrap: wrap; gap: 6px; font-size: 0.75rem; color: rgba(148, 163, 184, 0.85); }
      .tag-chip {
        display: inline-flex; align-items: center; gap: 4px;
        padding: 4px 10px; border-radius: 999px;
        background: rgba(56, 189, 248, 0.14);
        border: 1px solid rgba(56, 189, 248, 0.3);
        color: var(--accent);
      }

      .loading-state {
        display: flex;
        align-items: center;
        justify-content: center;
        gap: 12px;
        padding: 28px 18px;
        color: rgba(148, 163, 184, 0.8);
        font-size: 0.95rem;
      }
      .loading-state .spinner {
        width: 16px; height: 16px; border-radius: 50%;
        border: 2px solid rgba(148, 163, 184, 0.28);
        border-top-color: var(--accent);
        animation: spin 1s linear infinite;
      }
      @keyframes spin { from { transform: rotate(0deg); } to { transform: rotate(360deg); } }

      .footnote {
        margin-top: clamp(22px, 4vw, 32px);
        font-size: 0.85rem;
        color: rgba(148, 163, 184, 0.85);
        line-height: 1.6;
      }

      @media (max-width: 720px) {
        main { padding-top: clamp(60px, 12vw, 72px); }
        table, thead, tbody, th, td, tr { display: block; }
        thead { display: none; }
        tbody tr { border-bottom: 1px solid rgba(148, 163, 184, 0.18); padding: 18px 0; }
        tbody tr:last-child { border-bottom: none; }
        td { border: none; padding: 6px 0; }
        td::before {
          content: attr(data-label);
          display: block;
          font-size: 0.75rem;
          text-transform: uppercase;
          color: rgba(148, 163, 184, 0.72);
          margin-bottom: 4px;
          letter-spacing: 0.08em;
        }
        .repo { gap: 4px; }
      }
    </style>
  </head>
  <body>
    <main>
      <div class="top-bar">
        <button type="button" class="lang-toggle" data-lang-toggle aria-label="Switch language">
          <span data-lang-code="en" data-active="true">EN</span> / <span data-lang-code="zh-HK">繁</span>
        </button>
      </div>

      <header>
        <nav class="breadcrumb" aria-label="Breadcrumb">
          <a href="index.html" data-i18n="breadcrumbHome">← Back to Idea Hub</a>
          <span data-i18n="breadcrumbCurrent">Weekly snapshot</span>
        </nav>
        <h1 data-i18n="heroTitle">Top LLM &amp; AI GitHub Stars</h1>
        <p class="lead" data-i18n="heroLead">
          A curated snapshot of the fastest-growing AI and LLM repositories on GitHub this week. Use it to catch up on
          what the community is excited about, evaluate emerging tooling, or find inspiration for your own experiments.
        </p>
        <div class="snapshot-meta" aria-live="polite">
          <span data-week-range>Rolling 7-day window</span>
          <span data-i18n="metaSource">Source: GitHub Search API</span>
          <span data-last-updated>Last refreshed: —</span>
        </div>
      </header>

      <table role="table">
        <thead>
          <tr>
            <th scope="col" data-i18n="thRepository">Repository</th>
            <th scope="col" data-i18n="thHighlights">Highlights</th>
            <th scope="col" data-i18n="thStars">Stars (since launch)</th>
          </tr>
        </thead>
        <tbody data-results>
          <tr>
            <td colspan="3">
              <div class="loading-state" role="status">
                <span class="spinner" aria-hidden="true"></span>
                <span data-i18n="loading">Fetching live repositories…</span>
              </div>
            </td>
          </tr>
        </tbody>
      </table>

      <p class="footnote" data-i18n="footnote">
        Data refreshes automatically on page load using the public GitHub Search API with a rolling 7-day window. Star
        counts reflect each repository's total stars since creation during that window and are recalculated daily. If the
        API rate limit is reached, try again in a few minutes or supply a personal access token in the query string with
        <code>?token=&lt;your-token&gt;</code>.
      </p>

      <noscript>
        <p class="footnote">Enable JavaScript to load the latest weekly LLM and AI repositories from GitHub.</p>
      </noscript>
    </main>

    <script>
      const LOCALE_STORAGE_KEY = 'ideaHubLocale';
      const DEFAULT_LOCALE = 'en';
      const SUPPORTED_LOCALES = ['en', 'zh-HK'];

      const localeFallbacks = { en: 'en', 'zh-HK': 'zh-Hant-HK' };

      const translations = {
        en: {
          pageTitle: 'Top LLM & AI GitHub Stars (Weekly)',
          toggleAria: 'Switch to Traditional Chinese',
          breadcrumbHome: '← Back to Idea Hub',
          breadcrumbCurrent: 'Weekly snapshot',
          heroTitle: 'Top LLM & AI GitHub Stars',
          heroLead:
            'A curated snapshot of the fastest-growing AI and LLM repositories on GitHub this week. Use it to catch up on what the community is excited about, evaluate emerging tooling, or find inspiration for your own experiments.',
          metaSource: 'Source: GitHub Search API',
          metaUpdatedPrefix: 'Last refreshed: ',
          thRepository: 'Repository',
          thHighlights: 'Highlights',
          thStars: 'Stars (since launch)',
          loading: 'Fetching live repositories…',
          noResults: 'No repositories matched the filters this week. Check back soon!',
          genericError: 'Something went wrong. Please try again later.',
          noDescription: 'No description provided.',
          footnote:
            "Data refreshes automatically on page load using the public GitHub Search API with a rolling 7-day window. Star counts reflect each repository's total stars since creation during that window and are recalculated daily. If the API rate limit is reached, try again in a few minutes or supply a personal access token in the query string with <code>?token=&lt;your-token&gt;</code>.",
        },
        'zh-HK': {
          pageTitle: '每週 LLM 與 AI GitHub 星標排行榜',
          toggleAria: '切換至英文',
          breadcrumbHome: '← 返回 Idea Hub',
          breadcrumbCurrent: '每週快照',
          heroTitle: '每週 LLM 與 AI GitHub 星標排行榜',
          heroLead:
            '每週整理 GitHub 上成長最快的 AI 與 LLM 儲存庫，用來追蹤社群焦點、評估新工具，或為你的專案找靈感。',
          metaSource: '資料來源：GitHub Search API',
          metaUpdatedPrefix: '最後更新：',
          thRepository: '儲存庫',
          thHighlights: '重點',
          thStars: '星標（累計）',
          loading: '正在擷取最新儲存庫…',
          noResults: '本週沒有符合條件的儲存庫，稍後再來看看！',
          genericError: '載入時發生問題，請稍後再試。',
          noDescription: '沒有提供描述。',
          footnote:
            '重新整理頁面時會透過 GitHub Search API 自動更新，採用滾動 7 日視窗。星標數為儲存庫在該時段的累計總數，每日重新計算。若遇到 API 限制，可稍後再試，或於網址加上 <code>?token=&lt;your-token&gt;</code> 使用個人存取權杖。',
        },
      };

      const keywords = ['llm', 'language model', 'agent', 'agents', 'langchain', 'rag', 'vector', 'transformer', 'ai'];
      const maxRows = 5;

      const langToggle = document.querySelector('[data-lang-toggle]');
      const resultsBody = document.querySelector('[data-results]');
      const weekRangeLabel = document.querySelector('[data-week-range]');
      const lastUpdatedLabel = document.querySelector('[data-last-updated]');

      let currentLocale = DEFAULT_LOCALE;
      let cachedResults = [];
      let dataLoaded = false;

      function getStoredLocale() {
        const stored = localStorage.getItem(LOCALE_STORAGE_KEY);
        return SUPPORTED_LOCALES.includes(stored) ? stored : DEFAULT_LOCALE;
      }
      function persistLocale(locale) { localStorage.setItem(LOCALE_STORAGE_KEY, locale); }
      function applyLocaleToDocument(locale) { document.documentElement.lang = localeFallbacks[locale] || 'en'; }
      function updateToggleVisual(locale) {
        langToggle?.setAttribute('aria-label', translations[locale].toggleAria);
        langToggle?.querySelectorAll('span').forEach((span) => {
          const spanLocale = span.dataset.langCode;
          span.dataset.active = spanLocale === locale;
        });
      }

      function formatDate(date, options = {}) {
        return new Intl.DateTimeFormat(localeFallbacks[currentLocale] || 'en', {
          day: 'numeric', month: 'short', year: 'numeric', ...options,
        }).format(date);
      }
      function formatCompact(number) {
        return new Intl.NumberFormat(localeFallbacks[currentLocale] || 'en', {
          notation: 'compact', maximumFractionDigits: 1,
        }).format(number);
      }
      function formatTag(label) {
        return label.replace(/[-_]/g, ' ').replace(/\b\w/g, (m) => m.toUpperCase());
      }

      function renderStaticCopy() {
        Object.entries(translations[currentLocale]).forEach(([key, value]) => {
          document.querySelectorAll(`[data-i18n="${key}"]`).forEach((node) => {
            if (key === 'footnote') node.innerHTML = value; else node.textContent = value;
          });
        });
      }

      function renderMetaDates() {
        const now = new Date();
        const since = new Date(now);
        since.setDate(since.getDate() - 7);

        if (weekRangeLabel) {
          const from = formatDate(since, { day: 'numeric', month: 'short' });
          const to = formatDate(now, { day: 'numeric', month: 'short', year: 'numeric' });
          weekRangeLabel.textContent = `${from} – ${to}`;
        }
        if (lastUpdatedLabel) {
          const formattedNow = formatDate(now, { day: 'numeric', month: 'short', year: 'numeric' });
          lastUpdatedLabel.textContent = `${translations[currentLocale].metaUpdatedPrefix}${formattedNow}`;
        }
      }

      function showLoading() {
        resultsBody.innerHTML = `
          <tr>
            <td colspan="3">
              <div class="loading-state" role="status">
                <span class="spinner" aria-hidden="true"></span>
                <span>${translations[currentLocale].loading}</span>
              </div>
            </td>
          </tr>`;
      }

      function showError(messageKey) {
        const message = messageKey === 'noResults'
          ? translations[currentLocale].noResults
          : translations[currentLocale].genericError;
        resultsBody.innerHTML = `
          <tr>
            <td colspan="3">
              <div class="loading-state">
                <span aria-hidden="true">⚠️</span>
                <span>${message}</span>
              </div>
            </td>
          </tr>`;
      }

      function createRow(repo) {
        const tr = document.createElement('tr');

        const repoCell = document.createElement('td');
        repoCell.dataset.label = translations[currentLocale].thRepository;
        repoCell.innerHTML = `
          <div class="repo">
            <a href="${repo.html_url}" target="_blank" rel="noopener">${repo.full_name}</a>
            <div class="tags"></div>
          </div>`;

        const tagsContainer = repoCell.querySelector('.tags');
        const tagSet = new Set();
        const topics = repo.topics || [];
        topics.forEach((topic) => { if (tagSet.size < 3) tagSet.add(formatTag(topic)); });
        if (tagSet.size === 0) {
          const fallback = repo.language ? [repo.language] : [];
          [...fallback, 'AI', 'LLM'].forEach((item) => { if (tagSet.size < 3) tagSet.add(formatTag(item)); });
        }
        tagSet.forEach((tag) => {
          const span = document.createElement('span');
          span.className = 'tag-chip';
          span.textContent = tag;
          tagsContainer.appendChild(span);
        });

        const highlightsCell = document.createElement('td');
        highlightsCell.dataset.label = translations[currentLocale].thHighlights;
        const description = repo.description ? repo.description.trim() : translations[currentLocale].noDescription;
        highlightsCell.textContent = description;

        const starsCell = document.createElement('td');
        starsCell.dataset.label = translations[currentLocale].thStars;
        starsCell.textContent = `+${formatCompact(repo.stargazers_count)}`;

        tr.append(repoCell, highlightsCell, starsCell);
        return tr;
      }

      async function fetchQuery(query) {
        const searchParams = new URLSearchParams({ q: query, sort: 'stars', order: 'desc', per_page: '20' });
        const token = new URLSearchParams(window.location.search).get('token');
        const headers = { Accept: 'application/vnd.github+json' };
        if (token) headers.Authorization = `Bearer ${token}`;
        const response = await fetch(`https://api.github.com/search/repositories?${searchParams}`, { headers });
        if (!response.ok) throw new Error(`GitHub API error (${response.status})`);
        const payload = await response.json();
        return payload.items || [];
      }

      function repoIsRelevant(repo) {
        const haystack = [repo.name, repo.full_name, repo.description || '', ...(repo.topics || [])]
          .join(' ').toLowerCase();
        return keywords.some((k) => haystack.includes(k));
      }

      function renderResults() {
        if (!cachedResults.length) { dataLoaded ? showError('noResults') : showLoading(); return; }
        resultsBody.innerHTML = '';
        cachedResults.forEach((repo) => resultsBody.appendChild(createRow(repo)));
      }

      async function loadWeeklyStars() {
        const now = new Date();
        const since = new Date(now);
        since.setDate(since.getDate() - 7);
        const sinceIso = since.toISOString().slice(0, 10);

        const queries = [
          `created:>=${sinceIso}+stars:>=20+llm+in:name,description,readme`,
          `created:>=${sinceIso}+stars:>=20+ai+agent+in:name,description,readme`,
        ];

        const results = new Map();
        for (const q of queries) {
          try {
            const repos = await fetchQuery(q);
            repos.forEach((repo) => { if (!results.has(repo.id)) results.set(repo.id, repo); });
          } catch (err) {
            console.error(err);
            dataLoaded = true;
            showError('genericError');
            return;
          }
        }

        cachedResults = Array.from(results.values())
          .filter(repoIsRelevant)
          .sort((a, b) => b.stargazers_count - a.stargazers_count)
          .slice(0, maxRows);

        dataLoaded = true;
        renderResults();
      }

      function setLocale(locale, { rerenderOnly = false } = {}) {
        currentLocale = SUPPORTED_LOCALES.includes(locale) ? locale : DEFAULT_LOCALE;
        persistLocale(currentLocale);
        applyLocaleToDocument(currentLocale);
        updateToggleVisual(currentLocale);
        renderStaticCopy();
        document.title = translations[currentLocale].pageTitle;
        renderMetaDates();
        if (rerenderOnly) renderResults();
      }

      async function init() {
        currentLocale = getStoredLocale();
        setLocale(currentLocale);
        showLoading();
        await loadWeeklyStars();
        renderMetaDates();
      }

      document.querySelector('[data-lang-toggle]')?.addEventListener('click', () => {
        const nextLocale = currentLocale === 'en' ? 'zh-HK' : 'en';
        setLocale(nextLocale, { rerenderOnly: true });
      });

      init();
    </script>
  </body>
</html>
